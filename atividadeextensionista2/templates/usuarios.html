{% extends "base.html" %}

{% block title %}Início - Cidadania Ativa{% endblock %}

{% block content %}

<main class="fundo-cinza" style="max-width: 800px; margin: 40px auto;">
    <h2 style="text-align: center;">Top 5 Usuários Ativos</h2>
    <p style="text-align: center;">Total de usuários cadastrados: {{ total }}</p>

    <table class="tabela-usuarios">
        <thead>
            <tr>
                <th>Nome</th>
                <th>Postagens Feitas</th>
                <th>Interações Feitas</th>
                <th>Última Postagem</th>
            </tr>
        </thead>
        <tbody>
            {% for usuario in top_usuarios %}
                <tr>
                    <td>{{ usuario.username }}</td>
                    <td>{{ usuario.problemas | length }}</td>
                    <td>{{ usuario.validacoes | length }}</td>
                    <td>
                        {% set ultima_postagem = usuario.problemas | sort(attribute='data_criacao') | reverse | first %}
                        {{ ultima_postagem.data_criacao.strftime('%d/%m/%Y') }}
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</main>

{% endblock %}
